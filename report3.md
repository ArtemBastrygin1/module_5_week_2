# Отчет №3

## Управление пользователями и группами в Linux

### 1. Создание пользователя

Команда `adduser` используется для создания нового пользователя в системе.

Команда:

```bash
sudo adduser username
```

Эта команда создает нового пользователя с именем `username`. Во время выполнения команды система запросит пароль для нового пользователя, а также дополнительные данные, такие как полное имя.

### 2. Создание группы

Команда `groupadd` используется для создания новых групп в системе.

Команда:

```bash
sudo groupadd bbe_students
```

Эта команда создает новую группу с именем `bbe_students`. Группы позволяют объединять пользователей для удобного управления правами доступа.


### 3. Добавление пользователя в группу

Для добавления существующего пользователя в группу используется команда `usermod` с флагом `-aG`, который добавляет пользователя в группу, не удаляя его из других групп.

Команда:

```bash
sudo usermod -aG bbe_students username
```

Эта команда добавляет пользователя `username` в группу `bbe_students`. Теперь пользователь будет иметь доступ ко всем ресурсам, доступным этой группе.


### 4. Настройка прав доступа

Для изменения прав доступа к файлам и каталогам используется команда `chmod`.

Команда:

```bash
chmod 770 ~/work/project
```

Эта команда устанавливает права доступа на каталог `project` таким образом, что владелец и члены группы могут читать, записывать и выполнять файлы, а другие пользователи не имеют доступа.


### 5. Изменение владельца файла или каталога

Для изменения владельца файла или каталога используется команда `chown`. Она позволяет изменить владельца и/или группу, которой принадлежат файлы или каталоги.

Команда:

```bash
sudo chown :bbe_students ~/work/project
```

Эта команда изменяет группу владельца каталога `project` на группу `bbe_students`, предоставляя доступ только этой группе.


## Подключение к серверу с использованием SSH

1) **Проверка статуса SSH-сервера**

Для того чтобы убедиться, что SSH-сервер установлен и запущен, можно использовать команду `systemctl`.

Команда:

```bash
sudo systemctl status ssh
```

Но так как я работаю в контейнере я буду использовать команду 
`service ssh status`

В контейнерах использование `service ssh status` более распространено, потому что контейнеры редко содержат систему `systemd`, которая требуется для работы команды `systemctl`.

Команда:
```bash
service ssh status
```

Вывод команды:

```bash
* sshd is running
```

Это означает, что SSH-сервер работает и принимает подключения. Теперь мы можем подключаться к контейнеру через SSH.


2) **Генерация SSH-ключей**

Для создания SSH-ключей на вашем локальном компьютере используется команда `ssh-keygen`.

Команда:
```bash
ssh-keygen -t rsa -b 4096
```

Эта команда генерирует пару ключей с длиной ключа 4096 бит. Закрытый ключ будет храниться на вашем локальном компьютере, а открытый ключ нужно скопировать на сервер.

3) **Добавление ключей на сервер и подключение через SSH**

- Зайти в контейнер в bash:
```bash
docker exec -it contvnc /bin/bash
```

- Перейти в корневую директорию:
```bash
cd ~
```

- Затем создай файл `authorized_keys` в папке `.ssh`:
```bash
touch ~/.ssh/authorized_keys
```

- Отправляем ключ в созданную папку используя следующую команду:
```bash
docker cp /path/to/id_rsa.pub contvnc:/root/.ssh/authorized_keys
```

- Убедись, что sshd настроен для использования ключей:

В файле `/etc/ssh/sshd_config` должны быть строки:

```bash
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys
```
Проверить можно с помощью команды:

```bash
nano /etc/ssh/sshd_config
```
Потом также выполняем команды, чтобы сохранить и выйти:

- **Сохранить** файл `Ctrl + o'
- **Подтвердить** сохранение `inter`
- **Выйти** с файла `Ctrl + x`


- После этого нужно перезапустить службу ssh:

```bash
service ssh restart
```

- Можем подключаться с локалки на удаленную машину используя команду:

```bash
shh username@sever_id
```